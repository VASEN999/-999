# 自由职业身份类型处理问题修复说明

## 问题描述

发现当主申请人不是自由职业，但家属是自由职业的情况下，系统没有正确显示自由职业家属对应的自由职业材料。具体表现为：当家庭成员使用`FREELANCE`身份类型时，"其他材料"部分没有包含"自由职业或无业要写收入来源说明并提供相关的证明材料（包括家庭成员的申请）"这一项。

## 问题原因

系统中同时存在两种不同的自由职业身份标识：
1. `FREELANCER` - 主要用于配置文件和部分后端处理逻辑
2. `FREELANCE` - 主要用于前端表单和部分代码逻辑

由于不一致性，导致在检测家庭成员是否为自由职业者时，部分逻辑只检查了`FREELANCER`标识，遗漏了`FREELANCE`标识，从而导致使用`FREELANCE`标识的家庭成员没有正确生成相应的材料要求。

## 修复方案

1. 修改 `document_generator/other_materials.py`：
   - 将自由职业检测逻辑改为同时检查`FREELANCER`和`FREELANCE`标识
   - 添加更详细的日志记录，包括身份类型信息

2. 修改 `document_generator/family_materials.py`：
   - 将自由职业者身份类型检测扩展为同时检查`FREELANCER`和`FREELANCE`
   - 添加日志记录，便于调试和追踪

3. 修改 `document_generator/identity_materials.py`：
   - 添加`FREELANCE`标识的处理逻辑
   - 将`FREELANCE`标识转换为`FREELANCER`进行统一处理
   - 更新文档注释，标注两种标识的存在

4. 修改 `risk_assessment.py`：
   - 更新`_check_identity_risk`方法，同时检查`FREELANCER`和`FREELANCE`标识
   - 添加日志记录，便于问题追踪

## 测试验证

使用`debug_freelancer.py`脚本进行测试，分别测试了以下场景：
1. 主申请人为在职人员，家庭成员为`FREELANCER`标识的自由职业
2. 主申请人为在职人员，家庭成员为`FREELANCE`标识的自由职业

测试结果表明，修复后系统能正确处理两种标识，并在"其他材料"部分正确地添加自由职业相关的材料要求。

## 建议

1. 前后端标识统一：建议长期来看应统一使用一种标识，优先选择`FREELANCER`，因为配置文件中使用的是这个标识。
2. 编写更全面的单元测试：建议为不同的身份组合编写专门的单元测试，确保所有情况都能正确处理。
3. 添加参数验证：在表单处理阶段添加参数验证和标准化处理，确保后续处理逻辑只需处理统一的标识。 